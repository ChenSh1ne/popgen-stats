---
title: "dadiAnalysis"
author: "Abigail Shockey and Tatum Mortimer"
date: "August 18, 2016"
output: html_document
---

```{r, echo = FALSE, message = FALSE, warning = FALSE}

library(ggplot2)
library(reshape2)
ll <- data.frame(a=rep(NA, times = 100))
                 
```

## Expansion

### SFS

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 18, fig.height = 18}

observed_SFS <- read.table("observedSFS.txt")
neutral_SFS <- read.table("neutralModelSFS.txt")

expansion_SFS <- rbind(data.frame(Model="Observed", 
        Count=observed_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))),
    data.frame(Model="Neutral", 
        Count= neutral_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))))

if (file.exists("expansionModelSFS.txt")) {
  model <- read.table("expansionModelSFS.txt")
  expansion_SFS <- rbind(data.frame(Model = expansion_SFS$Model, 
      Count=expansion_SFS$Count,
      Frequency=expansion_SFS$Frequency),
  data.frame(Model = "Expansion", 
      Count = model$V1, 
      Frequency=as.numeric(row.names(model))))

  ggplot(expansion_SFS, aes(x=Frequency, y=Count, fill=Model)) +
    geom_bar(stat="identity", position="dodge") + 
    scale_fill_brewer(palette="Paired") +
    theme_bw() +
      theme(text = element_text(size=22),
      axis.text.x = element_text(angle=90, vjust=1),
      axis.line = element_line(colour = "black"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      #        panel.border = element_blank(),
      panel.background = element_blank())
}

```

### Parameter Values

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_expansionModel.txt")) {
  expansion_params <- read.table("dadi_expansionModel.txt", header = TRUE)
  params_df <- melt(expansion_params[,1:2], variable.name = "Parameter", value.name = "Value")
  ggplot(data = params_df, aes(x=Parameter, y=Value)) + geom_boxplot() +
      theme(text = element_text(size=14),
      axis.text.x = element_text(angle=90, vjust=1, size = 12))
}

```

### AIC

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_expansionModel.txt")) {
  Expansion <- expansion_params$ll
  ll <- cbind(ll, Expansion)
  avg_expansion_ll <- median(expansion_params$ll)
  cat("Average LL: ", avg_expansion_ll, "\n")
  avg_expansion_AIC <- 2 * 2 - 2 * avg_expansion_ll
  cat("Average AIC: ", avg_expansion_AIC, "\n")
  max_expansion_ll <- max(expansion_params$ll)
  cat("Max LL: ", max_expansion_ll, "\n")
  max_expansion_AIC <- 2 * 2 - 2 * max_expansion_ll
  cat("Max AIC: ", max_expansion_AIC, "\n")

}

```

## Growth

### SFS

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 18, fig.height = 18}

growth_SFS <- rbind(data.frame(Model="Observed", 
        Count=observed_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))),
    data.frame(Model="Neutral", 
        Count= neutral_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))))

if (file.exists("growthModelSFS.txt")) { 
    model <- read.table("growthModelSFS.txt")
    growth_SFS <- rbind(data.frame(Model = growth_SFS$Model, 
            Count=growth_SFS$Count,
            Frequency=growth_SFS$Frequency),
    data.frame(Model = "Exponential Growth", 
            Count = model$V1, 
            Frequency=as.numeric(row.names(model))))
    
    ggplot(growth_SFS, aes(x=Frequency, y=Count, fill=Model)) +
      geom_bar(stat="identity", position="dodge") + 
      scale_fill_brewer(palette="Paired") +
      theme_bw() +
        theme(text = element_text(size=22),
        axis.text.x = element_text(angle=90, vjust=1),
        axis.line = element_line(colour = "black"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        #        panel.border = element_blank(),
        panel.background = element_blank())
}

```

### Parameter Values

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_growthModel.txt")) {
  growth_params <- read.table("dadi_growthModel.txt", header = TRUE)
  ggplot(data = params_df, aes(x=Parameter, y=Value)) + geom_boxplot() +
      theme(text = element_text(size=16),
      axis.text.x = element_text(angle=90, vjust=1, size = 14))
}

```

### AIC

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_growthModel.txt")) {
  Growth <- growth_params$ll
  ll <- cbind(ll, Growth)
  avg_growth_ll = median(growth_params$ll)
  cat("Average LL: ", avg_growth_ll, "\n")
  avg_growth_AIC <- 2 * 2 - 2 * avg_growth_ll
  cat("Average AIC: ", avg_growth_AIC, "\n")
  max_growth_ll = max(growth_params$ll)
  cat("Max LL: ", max_growth_ll, "\n")
  max_growth_AIC <- 2 * 2 - 2 * max_growth_ll  
  cat("Max AIC: ", max_growth_AIC, "\n")
}

```

## Bottlegrowth

### SFS

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 18, fig.height = 18}

bottlegrowth_SFS <- rbind(data.frame(Model="Observed", 
        Count=observed_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))),
    data.frame(Model="Neutral", 
        Count= neutral_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))))
    
if (file.exists("bottlegrowthModelSFS.txt")) { 
  model <- read.table("bottlegrowthModelSFS.txt")
  bottlegrowth_SFS <- rbind(data.frame(Model = bottlegrowth_SFS$Model, 
                          Count=bottlegrowth_SFS$Count,
                          Frequency=bottlegrowth_SFS$Frequency),
               data.frame(Model = "Bottlegrowth", 
                          Count = model$V1, 
                          Frequency=as.numeric(row.names(model))))

  ggplot(bottlegrowth_SFS, aes(x=Frequency, y=Count, fill=Model)) +
    geom_bar(stat="identity", position="dodge") + 
    scale_fill_brewer(palette="Paired") +
    theme_bw() +
      theme(text = element_text(size=22),
      axis.text.x = element_text(angle=90, vjust=1),
      axis.line = element_line(colour = "black"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      #        panel.border = element_blank(),
      panel.background = element_blank())
}

```

### Parameter Values

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_bottlegrowthModel.txt")) {
  bottlegrowth_params <- read.table("dadi_bottlegrowthModel.txt", header = TRUE)
  params_df <- melt(bottlegrowth_params[,1:3], variable.name = "Parameter", value.name = "Value")
  ggplot(data = params_df, aes(x=Parameter, y=Value)) + geom_boxplot() +
      theme(text = element_text(size=16),
      axis.text.x = element_text(angle=90, vjust=1, size = 14))
}

```

### AIC

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_bottlegrowthModel.txt")) {
  Bottlegrowth <- bottlegrowth_params$ll
  ll <- cbind(ll, Bottlegrowth)
  avg_bottlegrowth_ll = median(bottlegrowth_params$ll)
  cat("Average LL: ", avg_bottlegrowth_ll, "\n")
  avg_bottlegrowth_AIC <- 2 * 2 - 2 * avg_bottlegrowth_ll
  cat("Average AIC: ", avg_bottlegrowth_AIC, "\n")  
  max_bottlegrowth_ll = max(bottlegrowth_params$ll)
  cat("Max LL: ", max_bottlegrowth_ll, "\n")
  max_bottlegrowth_AIC <- 2 * 2 - 2 * max_bottlegrowth_ll  
  cat("Max AIC: ", max_bottlegrowth_AIC, "\n")
}


```

## Bottleneck

### SFS

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 18, fig.height = 18}

bottleneck_SFS <- rbind(data.frame(Model="Observed", 
        Count=observed_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))),
    data.frame(Model="Neutral", 
        Count= neutral_SFS$V1,
        Frequency=as.numeric(row.names(observed_SFS))))
    
if (file.exists("bottleneckModelSFS.txt")) { 
  model <- read.table("bottleneckModelSFS.txt")
  bottleneck_SFS <- rbind(data.frame(Model = bottleneck_SFS$Model, 
                          Count=bottleneck_SFS$Count,
                          Frequency=bottleneck_SFS$Frequency),
               data.frame(Model = "Bottleneck", 
                          Count = model$V1, 
                          Frequency=as.numeric(row.names(model))))

  ggplot(bottleneck_SFS, aes(x=Frequency, y=Count, fill=Model)) +
    geom_bar(stat="identity", position="dodge") + 
    scale_fill_brewer(palette="Paired") +
    theme_bw() +
      theme(text = element_text(size=22),
      axis.text.x = element_text(angle=90, vjust=1),
      axis.line = element_line(colour = "black"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      #        panel.border = element_blank(),
      panel.background = element_blank())
}

```

### Parameter Values

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_bottleneckModel.txt")) {
  bottleneck_params <- read.table("dadi_bottleneckModel.txt", header = TRUE)
  params_df <- melt(bottleneck_params[,1:4], variable.name = "Parameter", value.name = "Value")
  ggplot(data = params_df, aes(x=Parameter, y=Value)) + geom_boxplot() +
      theme(text = element_text(size=14),
      axis.text.x = element_text(angle=90, vjust=1, size = 12))
}

```

### AIC

```{r, echo = FALSE, message = FALSE, warning = FALSE}

if (file.exists("dadi_bottleneckModel.txt")) {
  Bottleneck <- bottleneck_params$ll
  ll <- cbind(ll, Bottleneck)
  avg_bottleneck_ll = median(bottleneck_params$ll)
  cat("Average LL: ", avg_bottleneck_ll, "\n")
  avg_bottleneck_AIC <- 2 * 3 - 2 * avg_bottleneck_ll
  cat("Average AIC: ", avg_bottleneck_AIC, "\n")
  max_bottleneck_ll = max(bottleneck_params$ll)
  cat("Max LL: ", max_bottleneck_ll, "\n")
  max_bottleneck_AIC <- 2 * 3 - 2 * max_bottleneck_ll
  cat("Max AIC: ", max_bottleneck_AIC, "\n")
}

```

## LL

```{r, echo = FALSE, message = FALSE, warning = FALSE}

ll$a <- NULL
ggplot(data = melt(ll, variable.name = "Model", value.name = "LL"), aes(x=Model, y=LL)) + geom_boxplot()

```
